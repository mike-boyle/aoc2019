// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE
'use strict';

var $$Array = require("bs-platform/lib/js/array.js");
var Curry = require("bs-platform/lib/js/curry.js");
var Caml_array = require("bs-platform/lib/js/caml_array.js");
var Caml_int32 = require("bs-platform/lib/js/caml_int32.js");

var input = /* :: */[
  1,
  /* :: */[
    0,
    /* :: */[
      0,
      /* :: */[
        3,
        /* :: */[
          1,
          /* :: */[
            1,
            /* :: */[
              2,
              /* :: */[
                3,
                /* :: */[
                  1,
                  /* :: */[
                    3,
                    /* :: */[
                      4,
                      /* :: */[
                        3,
                        /* :: */[
                          1,
                          /* :: */[
                            5,
                            /* :: */[
                              0,
                              /* :: */[
                                3,
                                /* :: */[
                                  2,
                                  /* :: */[
                                    1,
                                    /* :: */[
                                      10,
                                      /* :: */[
                                        19,
                                        /* :: */[
                                          2,
                                          /* :: */[
                                            9,
                                            /* :: */[
                                              19,
                                              /* :: */[
                                                23,
                                                /* :: */[
                                                  2,
                                                  /* :: */[
                                                    23,
                                                    /* :: */[
                                                      10,
                                                      /* :: */[
                                                        27,
                                                        /* :: */[
                                                          1,
                                                          /* :: */[
                                                            6,
                                                            /* :: */[
                                                              27,
                                                              /* :: */[
                                                                31,
                                                                /* :: */[
                                                                  1,
                                                                  /* :: */[
                                                                    31,
                                                                    /* :: */[
                                                                      6,
                                                                      /* :: */[
                                                                        35,
                                                                        /* :: */[
                                                                          2,
                                                                          /* :: */[
                                                                            35,
                                                                            /* :: */[
                                                                              10,
                                                                              /* :: */[
                                                                                39,
                                                                                /* :: */[
                                                                                  1,
                                                                                  /* :: */[
                                                                                    39,
                                                                                    /* :: */[
                                                                                      5,
                                                                                      /* :: */[
                                                                                        43,
                                                                                        /* :: */[
                                                                                          2,
                                                                                          /* :: */[
                                                                                            6,
                                                                                            /* :: */[
                                                                                              43,
                                                                                              /* :: */[
                                                                                                47,
                                                                                                /* :: */[
                                                                                                  2,
                                                                                                  /* :: */[
                                                                                                    47,
                                                                                                    /* :: */[
                                                                                                      10,
                                                                                                      /* :: */[
                                                                                                        51,
                                                                                                        /* :: */[
                                                                                                          1,
                                                                                                          /* :: */[
                                                                                                            51,
                                                                                                            /* :: */[
                                                                                                              6,
                                                                                                              /* :: */[
                                                                                                                55,
                                                                                                                /* :: */[
                                                                                                                  1,
                                                                                                                  /* :: */[
                                                                                                                    55,
                                                                                                                    /* :: */[
                                                                                                                      6,
                                                                                                                      /* :: */[
                                                                                                                        59,
                                                                                                                        /* :: */[
                                                                                                                          1,
                                                                                                                          /* :: */[
                                                                                                                            9,
                                                                                                                            /* :: */[
                                                                                                                              59,
                                                                                                                              /* :: */[
                                                                                                                                63,
                                                                                                                                /* :: */[
                                                                                                                                  1,
                                                                                                                                  /* :: */[
                                                                                                                                    63,
                                                                                                                                    /* :: */[
                                                                                                                                      9,
                                                                                                                                      /* :: */[
                                                                                                                                        67,
                                                                                                                                        /* :: */[
                                                                                                                                          1,
                                                                                                                                          /* :: */[
                                                                                                                                            67,
                                                                                                                                            /* :: */[
                                                                                                                                              6,
                                                                                                                                              /* :: */[
                                                                                                                                                71,
                                                                                                                                                /* :: */[
                                                                                                                                                  2,
                                                                                                                                                  /* :: */[
                                                                                                                                                    71,
                                                                                                                                                    /* :: */[
                                                                                                                                                      13,
                                                                                                                                                      /* :: */[
                                                                                                                                                        75,
                                                                                                                                                        /* :: */[
                                                                                                                                                          1,
                                                                                                                                                          /* :: */[
                                                                                                                                                            75,
                                                                                                                                                            /* :: */[
                                                                                                                                                              5,
                                                                                                                                                              /* :: */[
                                                                                                                                                                79,
                                                                                                                                                                /* :: */[
                                                                                                                                                                  1,
                                                                                                                                                                  /* :: */[
                                                                                                                                                                    79,
                                                                                                                                                                    /* :: */[
                                                                                                                                                                      9,
                                                                                                                                                                      /* :: */[
                                                                                                                                                                        83,
                                                                                                                                                                        /* :: */[
                                                                                                                                                                          2,
                                                                                                                                                                          /* :: */[
                                                                                                                                                                            6,
                                                                                                                                                                            /* :: */[
                                                                                                                                                                              83,
                                                                                                                                                                              /* :: */[
                                                                                                                                                                                87,
                                                                                                                                                                                /* :: */[
                                                                                                                                                                                  1,
                                                                                                                                                                                  /* :: */[
                                                                                                                                                                                    87,
                                                                                                                                                                                    /* :: */[
                                                                                                                                                                                      5,
                                                                                                                                                                                      /* :: */[
                                                                                                                                                                                        91,
                                                                                                                                                                                        /* :: */[
                                                                                                                                                                                          2,
                                                                                                                                                                                          /* :: */[
                                                                                                                                                                                            6,
                                                                                                                                                                                            /* :: */[
                                                                                                                                                                                              91,
                                                                                                                                                                                              /* :: */[
                                                                                                                                                                                                95,
                                                                                                                                                                                                /* :: */[
                                                                                                                                                                                                  1,
                                                                                                                                                                                                  /* :: */[
                                                                                                                                                                                                    95,
                                                                                                                                                                                                    /* :: */[
                                                                                                                                                                                                      9,
                                                                                                                                                                                                      /* :: */[
                                                                                                                                                                                                        99,
                                                                                                                                                                                                        /* :: */[
                                                                                                                                                                                                          2,
                                                                                                                                                                                                          /* :: */[
                                                                                                                                                                                                            6,
                                                                                                                                                                                                            /* :: */[
                                                                                                                                                                                                              99,
                                                                                                                                                                                                              /* :: */[
                                                                                                                                                                                                                103,
                                                                                                                                                                                                                /* :: */[
                                                                                                                                                                                                                  1,
                                                                                                                                                                                                                  /* :: */[
                                                                                                                                                                                                                    5,
                                                                                                                                                                                                                    /* :: */[
                                                                                                                                                                                                                      103,
                                                                                                                                                                                                                      /* :: */[
                                                                                                                                                                                                                        107,
                                                                                                                                                                                                                        /* :: */[
                                                                                                                                                                                                                          1,
                                                                                                                                                                                                                          /* :: */[
                                                                                                                                                                                                                            6,
                                                                                                                                                                                                                            /* :: */[
                                                                                                                                                                                                                              107,
                                                                                                                                                                                                                              /* :: */[
                                                                                                                                                                                                                                111,
                                                                                                                                                                                                                                /* :: */[
                                                                                                                                                                                                                                  1,
                                                                                                                                                                                                                                  /* :: */[
                                                                                                                                                                                                                                    111,
                                                                                                                                                                                                                                    /* :: */[
                                                                                                                                                                                                                                      10,
                                                                                                                                                                                                                                      /* :: */[
                                                                                                                                                                                                                                        115,
                                                                                                                                                                                                                                        /* :: */[
                                                                                                                                                                                                                                          2,
                                                                                                                                                                                                                                          /* :: */[
                                                                                                                                                                                                                                            115,
                                                                                                                                                                                                                                            /* :: */[
                                                                                                                                                                                                                                              13,
                                                                                                                                                                                                                                              /* :: */[
                                                                                                                                                                                                                                                119,
                                                                                                                                                                                                                                                /* :: */[
                                                                                                                                                                                                                                                  1,
                                                                                                                                                                                                                                                  /* :: */[
                                                                                                                                                                                                                                                    119,
                                                                                                                                                                                                                                                    /* :: */[
                                                                                                                                                                                                                                                      6,
                                                                                                                                                                                                                                                      /* :: */[
                                                                                                                                                                                                                                                        123,
                                                                                                                                                                                                                                                        /* :: */[
                                                                                                                                                                                                                                                          1,
                                                                                                                                                                                                                                                          /* :: */[
                                                                                                                                                                                                                                                            123,
                                                                                                                                                                                                                                                            /* :: */[
                                                                                                                                                                                                                                                              2,
                                                                                                                                                                                                                                                              /* :: */[
                                                                                                                                                                                                                                                                127,
                                                                                                                                                                                                                                                                /* :: */[
                                                                                                                                                                                                                                                                  1,
                                                                                                                                                                                                                                                                  /* :: */[
                                                                                                                                                                                                                                                                    127,
                                                                                                                                                                                                                                                                    /* :: */[
                                                                                                                                                                                                                                                                      5,
                                                                                                                                                                                                                                                                      /* :: */[
                                                                                                                                                                                                                                                                        0,
                                                                                                                                                                                                                                                                        /* :: */[
                                                                                                                                                                                                                                                                          99,
                                                                                                                                                                                                                                                                          /* :: */[
                                                                                                                                                                                                                                                                            2,
                                                                                                                                                                                                                                                                            /* :: */[
                                                                                                                                                                                                                                                                              14,
                                                                                                                                                                                                                                                                              /* :: */[
                                                                                                                                                                                                                                                                                0,
                                                                                                                                                                                                                                                                                /* :: */[
                                                                                                                                                                                                                                                                                  0,
                                                                                                                                                                                                                                                                                  /* [] */0
                                                                                                                                                                                                                                                                                ]
                                                                                                                                                                                                                                                                              ]
                                                                                                                                                                                                                                                                            ]
                                                                                                                                                                                                                                                                          ]
                                                                                                                                                                                                                                                                        ]
                                                                                                                                                                                                                                                                      ]
                                                                                                                                                                                                                                                                    ]
                                                                                                                                                                                                                                                                  ]
                                                                                                                                                                                                                                                                ]
                                                                                                                                                                                                                                                              ]
                                                                                                                                                                                                                                                            ]
                                                                                                                                                                                                                                                          ]
                                                                                                                                                                                                                                                        ]
                                                                                                                                                                                                                                                      ]
                                                                                                                                                                                                                                                    ]
                                                                                                                                                                                                                                                  ]
                                                                                                                                                                                                                                                ]
                                                                                                                                                                                                                                              ]
                                                                                                                                                                                                                                            ]
                                                                                                                                                                                                                                          ]
                                                                                                                                                                                                                                        ]
                                                                                                                                                                                                                                      ]
                                                                                                                                                                                                                                    ]
                                                                                                                                                                                                                                  ]
                                                                                                                                                                                                                                ]
                                                                                                                                                                                                                              ]
                                                                                                                                                                                                                            ]
                                                                                                                                                                                                                          ]
                                                                                                                                                                                                                        ]
                                                                                                                                                                                                                      ]
                                                                                                                                                                                                                    ]
                                                                                                                                                                                                                  ]
                                                                                                                                                                                                                ]
                                                                                                                                                                                                              ]
                                                                                                                                                                                                            ]
                                                                                                                                                                                                          ]
                                                                                                                                                                                                        ]
                                                                                                                                                                                                      ]
                                                                                                                                                                                                    ]
                                                                                                                                                                                                  ]
                                                                                                                                                                                                ]
                                                                                                                                                                                              ]
                                                                                                                                                                                            ]
                                                                                                                                                                                          ]
                                                                                                                                                                                        ]
                                                                                                                                                                                      ]
                                                                                                                                                                                    ]
                                                                                                                                                                                  ]
                                                                                                                                                                                ]
                                                                                                                                                                              ]
                                                                                                                                                                            ]
                                                                                                                                                                          ]
                                                                                                                                                                        ]
                                                                                                                                                                      ]
                                                                                                                                                                    ]
                                                                                                                                                                  ]
                                                                                                                                                                ]
                                                                                                                                                              ]
                                                                                                                                                            ]
                                                                                                                                                          ]
                                                                                                                                                        ]
                                                                                                                                                      ]
                                                                                                                                                    ]
                                                                                                                                                  ]
                                                                                                                                                ]
                                                                                                                                              ]
                                                                                                                                            ]
                                                                                                                                          ]
                                                                                                                                        ]
                                                                                                                                      ]
                                                                                                                                    ]
                                                                                                                                  ]
                                                                                                                                ]
                                                                                                                              ]
                                                                                                                            ]
                                                                                                                          ]
                                                                                                                        ]
                                                                                                                      ]
                                                                                                                    ]
                                                                                                                  ]
                                                                                                                ]
                                                                                                              ]
                                                                                                            ]
                                                                                                          ]
                                                                                                        ]
                                                                                                      ]
                                                                                                    ]
                                                                                                  ]
                                                                                                ]
                                                                                              ]
                                                                                            ]
                                                                                          ]
                                                                                        ]
                                                                                      ]
                                                                                    ]
                                                                                  ]
                                                                                ]
                                                                              ]
                                                                            ]
                                                                          ]
                                                                        ]
                                                                      ]
                                                                    ]
                                                                  ]
                                                                ]
                                                              ]
                                                            ]
                                                          ]
                                                        ]
                                                      ]
                                                    ]
                                                  ]
                                                ]
                                              ]
                                            ]
                                          ]
                                        ]
                                      ]
                                    ]
                                  ]
                                ]
                              ]
                            ]
                          ]
                        ]
                      ]
                    ]
                  ]
                ]
              ]
            ]
          ]
        ]
      ]
    ]
  ]
];

var example = /* array */[
  1,
  9,
  10,
  3,
  2,
  3,
  11,
  0,
  99,
  30,
  40,
  50
];

function arrayToString(param) {
  return $$Array.fold_left((function (acc, v) {
                return acc + (", " + String(v));
              }), "", param);
}

function program(i) {
  var handleOperation = function (op, pc) {
    var result = Curry._2(op, Caml_array.caml_array_get(i, Caml_array.caml_array_get(i, pc + 1 | 0)), Caml_array.caml_array_get(i, Caml_array.caml_array_get(i, pc + 2 | 0)));
    var outputPosition = Caml_array.caml_array_get(i, pc + 3 | 0);
    Caml_array.caml_array_set(i, outputPosition, result);
    return pc + 4 | 0;
  };
  var handleAddition = function (param) {
    return handleOperation((function (prim, prim$1) {
                  return prim + prim$1 | 0;
                }), param);
  };
  var handleMultiplication = function (param) {
    return handleOperation(Caml_int32.imul, param);
  };
  var pc = 0;
  while(Caml_array.caml_array_get(i, pc) !== 99) {
    var curPc = pc;
    var match = Caml_array.caml_array_get(i, curPc);
    var pcOption = match !== 1 ? (
        match !== 2 ? undefined : handleMultiplication(curPc)
      ) : handleAddition(curPc);
    pc = pcOption !== undefined ? pcOption : 99;
  };
  return Caml_array.caml_array_get(i, 0);
}

function runProgram(noun, verb) {
  var memory = $$Array.of_list(input);
  Caml_array.caml_array_set(memory, 1, noun);
  Caml_array.caml_array_set(memory, 2, verb);
  return program(memory);
}

function findMatchingNounAndVerb(param) {
  var tryValue = function (_noun, _verb) {
    while(true) {
      var verb = _verb;
      var noun = _noun;
      var match = runProgram(noun, verb);
      if (match !== 19690720) {
        if (noun === 100 && verb === 100) {
          return ;
        }
        
      } else {
        return Caml_int32.imul(100, noun) + verb | 0;
      }
      if (verb !== 100) {
        _verb = verb + 1 | 0;
        continue ;
      } else {
        _verb = 0;
        _noun = noun + 1 | 0;
        continue ;
      }
    };
  };
  var match = tryValue(0, 0);
  if (match !== undefined) {
    return String(match);
  } else {
    return "Not found!";
  }
}

console.log(runProgram(12, 2));

console.log(findMatchingNounAndVerb(/* () */0));

exports.input = input;
exports.example = example;
exports.arrayToString = arrayToString;
exports.program = program;
exports.runProgram = runProgram;
exports.findMatchingNounAndVerb = findMatchingNounAndVerb;
/*  Not a pure module */
